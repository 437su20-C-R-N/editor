{% extends "editor.html" %}
{% load verbatim %}

{% block javascripts %}
    {{ block.super }}

    <!-- question editor -->
    <script src="{{ STATIC_URL }}js/numbas/R/R.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/numbas/R/en-gb.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/numbas/numbas.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/question/edit.js" type="text/javascript"></script>

    <script type="text/javascript">
        (function() {
            if (!window.Editor) {
                window.Editor = {};
            }
            var Editor = window.Editor;
            Editor['preview_url'] = '{% url question_preview object.pk object.slug %}';
            Editor['download_url'] = '{% url question_download object.pk object.slug %}';
			Editor.questionJSON = {% autoescape off %}{{question.as_json}}{% endautoescape %};

			Editor.numbasExtensions = {% autoescape off %}{{extensions}}{% endautoescape %};
        })();
    </script>
{% endblock javascripts %}
	
{% block content %}
	{{block.super }}

    {% block property_templates %}{% endblock %}

	<div id="question" class="{% if not editable %}nonedit{% endif %}">
		<div id="controls">
			{% block controls %}
    			<div id="editable_message">{% block editable_message %}{% endblock %}</div>
				<div class="controlbox" id="author">
					Author: {{ object.author.first_name }} {{ object.author.last_name }} ({{ object.author.username }})
				</div>
				<div class="controlbox" id="buttons">
					Download: 
					<a href="{% url question_download object.pk object.slug %}">standalone .zip</a>,
					<a href="{% url question_download object.pk object.slug %}?scorm">SCORM package</a>,
					<a href="{% url question_source object.pk object.slug %}">source</a>
				</div>
                <div class="controlbox" id="admin">
    				<a id="preview" href="{% url question_preview object.pk object.slug %}">Test Run</a>
					
					{% if editable %}
						<a id="delete" href="{% url question_delete object.pk object.slug %}">Delete</a>
					{% endif %}
					
					<a id="copy" href="{% url question_copy object.pk object.slug %}">Make a Copy</a>
				</div>
			{% endblock controls %}
		</div>
		<div id="editor" data-bind="template: 'questionTemplate'">Loading...</div>
	</div>

{% endblock content %}
